# <center>爱丽丝QQ聊天AI界面开发随笔</center>
FramelessWindow 组件自带最大化、窗口拖拽等功能，可以用以下代码禁用。
```python
self.titleBar.maxBtn.deleteLater() # 移除最大化按钮
self.titleBar._isDoubleClickEnabled = False # 禁用双击放大
self.setResizeEnabled(False) # 禁用窗口拖拽


self.titleBar.closeBtn.hide()   # 隐藏关闭按钮
self.titleBar.maxBtn.hide()     # 隐藏最大化按钮
self.titleBar.minBtn.hide()     # 隐藏最小化按钮
```

PyQt 文档 v6.9.0 » 参考指南
https://www.riverbankcomputing.com/static/Docs/PyQt6/index.html

适用于 Python 的 Qt
https://doc.qt.io/qtforpython-6/


### qrc资源文件转py文件
不知道为什么`pyrcc5`给我报错，***转完之后去他的py文件把Qt5改成Qt6就能用了***
```bash
pyrcc5 ./resources/resources.qrc -o ./resources/resources.py
```
只有这个路径里面rcc.exe，不知道啥原因吧，反正AI确实没救了，只能用pyrcc5
`A:\Anaconda3\envs\Qt6\Lib\site-packages\qt6_applications\Qt\bin`


### bug
***继承`后bug确实挺多了，其中就包括系统托盘的bug`***
猜测系统托盘没法正常隐藏和缩放也跟他有关

双击在标题栏区域它没法感应，也不知道是我设计designer出的问题还是啥？
```python
def mouseDoubleClickEvent(self, event):
    """重写双击事件
    双击会改变窗口放大和缩小的状态，届时图标也需要跟着一起变才行
    """
    if self.isMaximized():  # 判断是否最大化
        self.max_btn.setIcon(self.restore_icon)  # 最大化则修改图标为回复
    else:
        self.max_btn.setIcon(self.max_icon)  # 非最大化则修改图标为最大化
    super().mouseDoubleClickEvent(event)    # 继承父类的双击
    print(self.isMaximized())
```

在样式表里面，如果设置成这样会导致在代码中无法修改图标
```css
QPushButton {
    background: transparent;  /* 透明背景 */
    border: none;            /* 移除默认边框 */
	icon: url(:/标题栏/标题栏/最大化.png); /*最大化图标*/
}
/* 悬停状态 */
QPushButton:hover {
    background: rgb(233, 233, 233); /* 轻微高亮 */
}
/* 按下状态 */
QPushButton:pressed {
    background: rgb(213, 213, 213);
}
/* 选中状态显示*/
QPushButton:checked {
    icon: url(:/标题栏/标题栏/窗口恢复.png);	/*恢复图标*/
}
```

使用原生的窗口置顶方法是窗口会抖一下，或则叫闪一下
`self.toggleStayOnTop()`，这个方法能够切换置顶或非置顶，但是就是屏幕会闪一下，我就是很不满意闪的那一下，我直接用win32api给他改改，改完之后就舒服多了，但是Qt好像无法检测窗口是否置顶的状态了
```python
def switch_top(self):
    """窗口置顶切换"""
    # 如果窗口置顶了就给他取消置顶
    if win32gui.GetWindowLong(self.hwnd, win32con.GWL_EXSTYLE) & win32con.WS_EX_TOPMOST:
        win32gui.SetWindowPos(self.hwnd,win32con.HWND_TOPMOST,0, 0, 0, 0,win32con.SWP_NOMOVE | win32con.SWP_NOSIZE)
    else:   # 如果窗口没有置顶则置顶窗口
        win32gui.SetWindowPos(self.hwnd,win32con.HWND_NOTOPMOST,0, 0, 0, 0,win32con.SWP_NOMOVE | win32con.SWP_NOSIZE)
```
### 系统托盘
本来有一个最小化到系统托盘按钮的，但是Qt的系统托盘存在bug我就直接移除了改按钮和相关功能


通过继承无边框窗口后不知道为什么拖拽收到了影响，导致我自定义标题栏的图标和标签无法拖拽，然后我直接重写
```python
self.offset = QPoint()      # 记录拖拽位置
def mousePressEvent(self, event):
    # 记录鼠标按下的初始位置
    self.offset = event.pos()   # 记录偏移位置

def mouseMoveEvent(self, event):
    # 移动窗口位置
    if event.buttons() == Qt.MouseButton.LeftButton:    # 左击
        self.move(self.pos() + event.pos() - self.offset)
```

第一次觉得PyQt6的bug这么多，第一次还能用，第二次就不行了
```python
self.min_system_tray_btn.clicked.connect(self.system_tray.hide)  # 最小化到系统托盘按钮
self.hide_btn.clicked.connect(self.system_tray.show)  # 隐藏窗口按钮(隐藏窗口和系统托盘)
```


## 免责声明
1. 本项目开发中涉及到的有关BA的资源归蔚蓝档案官方及各位二创大佬所有，本人仅用于学习参考，如有侵权通知立删。
2. 本项目纯粹免费开源，不牟利（不进行商业化），严格遵守PyQt6的版权协议。
